{
  "id": "d1af7c1c-f221-4e41-84d6-2f8d0ba493fb",
  "bpnModelId": "d61af972-15dd-4050-8028-4241dbb28ad4",
  "createdBy": "Brandon Choy",
  "modifiedBy": "Brandon Choy",
  "created": {
    "seconds": 1561368009,
    "nanos": 908000000
  },
  "modified": {
    "seconds": 1561368009,
    "nanos": 908000000
  },
  "modelRevisionStatus": "DEPLOYED",
  "creatorType": "HUMAN",
  "bpnModelRevisionNumber": "3.0",
  "allowedActions": 5,
  "mergeable": false,
  "revisionXml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?><bpmn2:definitions xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:bpmn2=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:dc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:di=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:prop=\"http://www.ipsoft.com/schema/bpmn/prop\" id=\"sample-diagram\" targetNamespace=\"http://bpmn.io/schema/bpmn\" xsi:schemaLocation=\"http://www.omg.org/spec/BPMN/20100524/MODEL BPMN20.xsd\">\n  <bpmn2:process id=\"Process_1\" name=\"doList\" isExecutable=\"false\">\n    <bpmn2:startEvent id=\"StartEvent_1\">\n      <bpmn2:outgoing>SequenceFlow_1spog3v</bpmn2:outgoing>\n    </bpmn2:startEvent>\n    <bpmn2:sequenceFlow id=\"SequenceFlow_1spog3v\" sourceRef=\"StartEvent_1\" targetRef=\"Task_0ybjinw\"/>\n    <bpmn2:userTask id=\"Task_0ybjinw\" name=\"say we have several locations to pick from\">\n      <bpmn2:incoming>SequenceFlow_1spog3v</bpmn2:incoming>\n      <bpmn2:outgoing>SequenceFlow_0qrqwew</bpmn2:outgoing>\n    </bpmn2:userTask>\n    <bpmn2:sequenceFlow id=\"SequenceFlow_0qrqwew\" sourceRef=\"Task_0ybjinw\" targetRef=\"Task_1f8kw12\"/>\n    <bpmn2:scriptTask id=\"Task_1f8kw12\" name=\"suggest response\" scriptFormat=\"groovy\">\n      <bpmn2:extensionElements>\n        <prop:property name=\"included_scripts\" value=\"\"/>\n      </bpmn2:extensionElements>\n      <bpmn2:incoming>SequenceFlow_0qrqwew</bpmn2:incoming>\n      <bpmn2:outgoing>SequenceFlow_1o2l47o</bpmn2:outgoing>\n      <bpmn2:script>def formInputData = formInputDataBuilder.create()\n          .name(\"locationSelectionForm\")\n          .allowedUserInputs(\"both\")\n\t\t  .instructions(\"strict\")\n          .addField()\n              .name(\"locationSelectionField\")\n              .fieldType(\"AutoComplete\")\n              .postfixedSelectionUtterance(\"I select the location\", \"I select the location\")\n              .addOption()\n                  .name(\"Franklin Lakes\")\n                  .nameForDisplay(\"Ohio\")\n                  .value(\"Franklin Lakes\")\n                  .backToField()\n              .addOption()\n                  .name(\"Bangsar South\")\n                  .nameForDisplay(\"Kuala Lumpur\")\n                  .value(\"Bangsar South\") \n                  .backToField()\n              .backToForm()\n          .build();\n \nexecution.setVariable('formInputData', formInputData.toString())</bpmn2:script>\n    </bpmn2:scriptTask>\n    <bpmn2:sequenceFlow id=\"SequenceFlow_1o2l47o\" sourceRef=\"Task_1f8kw12\" targetRef=\"Task_0k4nrqz\"/>\n    <bpmn2:userTask id=\"Task_0k4nrqz\" name=\"ask &quot;Where would you like to go?&quot;\">\n      <bpmn2:extensionElements>\n        <prop:property name=\"ask_first_pass_behavior\" value=\"AlwaysAsk\"/>\n        <prop:property name=\"ask_subsequent_pass_behavior\" value=\"AlwaysAsk\"/>\n        <prop:property name=\"form_input_data_variable\" value=\"formInputData\"/>\n        <prop:property name=\"user_task_hint_text\" value=\"\"/>\n      </bpmn2:extensionElements>\n      <bpmn2:incoming>SequenceFlow_1o2l47o</bpmn2:incoming>\n      <bpmn2:outgoing>SequenceFlow_088l1mq</bpmn2:outgoing>\n    </bpmn2:userTask>\n    <bpmn2:endEvent id=\"EndEvent_010c5vf\">\n      <bpmn2:incoming>SequenceFlow_008359c</bpmn2:incoming>\n    </bpmn2:endEvent>\n    <bpmn2:sequenceFlow id=\"SequenceFlow_088l1mq\" sourceRef=\"Task_0k4nrqz\" targetRef=\"Task_04u9ote\"/>\n    <bpmn2:sequenceFlow id=\"SequenceFlow_0jndtap\" sourceRef=\"Task_04u9ote\" targetRef=\"Task_1d5e61v\"/>\n    <bpmn2:scriptTask id=\"Task_1d5e61v\" name=\"creates chat notes\" scriptFormat=\"groovy\">\n      <bpmn2:extensionElements>\n        <prop:property name=\"included_scripts\" value=\"\"/>\n      </bpmn2:extensionElements>\n      <bpmn2:incoming>SequenceFlow_0jndtap</bpmn2:incoming>\n      <bpmn2:outgoing>SequenceFlow_1j3u782</bpmn2:outgoing>\n      <bpmn2:script>import groovy.json.JsonOutput\n \ndef bucket = cmService.getBucketResources('mybucket')\ndef selectedName = execution.getVariable(\"response\")\ndef imageExtension = \".PNG\"\n\nfor(i = 0; i &lt; bucket.size(); i++){\n    if(bucket[i].objectName().matches(selectedName.replaceAll(\" \", \"\")+imageExtension)){\n        def imageId = bucket[i].objectId()\n        execution.setVariable('imageId', imageId.toString())\n    }\n}\n\ndef imageId = execution.getVariable('imageId')\n\ndef imageUrl = cmService.getResourceUrl(imageId)\n \ndef payload = [\n    action       : 'addChatNotesIntegration',\n    componentType: 'ChatNote',\n    payload      : [\n        [\n        component    : 'ChatNote',\n        header       : 'Welcome to Amelia',\n        title        : 'Amelia Asks Questions',\n        subcomponents: [\n            [\n            subcomponent: 'Markup',\n            markupType  : 'ImageLarge',\n            label       : 'Carcrash',\n            imageBase64 : imageUrl,\n\t\t\tlabel: 'Location Map',\n\t\t\tdescription: selectedName+'\\n\\n\\n'\n            ]\n        ]\n \n        ]\n    ]\n]\n \ndef jsonString = JsonOutput.toJson(payload)\n\nexecution.setVariable('jsonString',jsonString)</bpmn2:script>\n    </bpmn2:scriptTask>\n    <bpmn2:sequenceFlow id=\"SequenceFlow_1j3u782\" sourceRef=\"Task_1d5e61v\" targetRef=\"Task_08me18p\"/>\n    <bpmn2:userTask id=\"Task_08me18p\" name=\"send the integration message jsonString\">\n      <bpmn2:incoming>SequenceFlow_1j3u782</bpmn2:incoming>\n      <bpmn2:outgoing>SequenceFlow_008359c</bpmn2:outgoing>\n    </bpmn2:userTask>\n    <bpmn2:sequenceFlow id=\"SequenceFlow_008359c\" sourceRef=\"Task_08me18p\" targetRef=\"EndEvent_010c5vf\"/>\n    <bpmn2:userTask id=\"Task_04u9ote\" name=\"say ${response}\">\n      <bpmn2:incoming>SequenceFlow_088l1mq</bpmn2:incoming>\n      <bpmn2:outgoing>SequenceFlow_0jndtap</bpmn2:outgoing>\n    </bpmn2:userTask>\n  </bpmn2:process>\n  <bpmndi:BPMNDiagram id=\"BPMNDiagram_1\">\n    <bpmndi:BPMNPlane id=\"BPMNPlane_1\" bpmnElement=\"Process_1\">\n      <bpmndi:BPMNShape id=\"_BPMNShape_StartEvent_2\" bpmnElement=\"StartEvent_1\">\n        <dc:Bounds x=\"176\" y=\"170\" width=\"36\" height=\"36\"/>\n        <bpmndi:BPMNLabel>\n          <dc:Bounds x=\"149\" y=\"206\" width=\"90\" height=\"20\"/>\n        </bpmndi:BPMNLabel>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNEdge id=\"SequenceFlow_1spog3v_di\" bpmnElement=\"SequenceFlow_1spog3v\">\n        <di:waypoint x=\"212\" y=\"188\"/>\n        <di:waypoint x=\"276\" y=\"188\"/>\n        <bpmndi:BPMNLabel>\n          <dc:Bounds x=\"199\" y=\"167\" width=\"90\" height=\"12\"/>\n        </bpmndi:BPMNLabel>\n      </bpmndi:BPMNEdge>\n      <bpmndi:BPMNShape id=\"UserTask_0dpery3_di\" bpmnElement=\"Task_0ybjinw\">\n        <dc:Bounds x=\"276\" y=\"148\" width=\"120\" height=\"80\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNEdge id=\"SequenceFlow_0qrqwew_di\" bpmnElement=\"SequenceFlow_0qrqwew\">\n        <di:waypoint x=\"396\" y=\"188\"/>\n        <di:waypoint x=\"438\" y=\"188\"/>\n        <bpmndi:BPMNLabel>\n          <dc:Bounds x=\"372\" y=\"167\" width=\"90\" height=\"12\"/>\n        </bpmndi:BPMNLabel>\n      </bpmndi:BPMNEdge>\n      <bpmndi:BPMNShape id=\"ScriptTask_159zize_di\" bpmnElement=\"Task_1f8kw12\">\n        <dc:Bounds x=\"438\" y=\"148\" width=\"120\" height=\"80\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNEdge id=\"SequenceFlow_1o2l47o_di\" bpmnElement=\"SequenceFlow_1o2l47o\">\n        <di:waypoint x=\"558\" y=\"188\"/>\n        <di:waypoint x=\"592\" y=\"188\"/>\n        <bpmndi:BPMNLabel>\n          <dc:Bounds x=\"531\" y=\"167\" width=\"90\" height=\"12\"/>\n        </bpmndi:BPMNLabel>\n      </bpmndi:BPMNEdge>\n      <bpmndi:BPMNShape id=\"UserTask_1m86wn8_di\" bpmnElement=\"Task_0k4nrqz\">\n        <dc:Bounds x=\"592\" y=\"148\" width=\"120\" height=\"80\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNShape id=\"EndEvent_010c5vf_di\" bpmnElement=\"EndEvent_010c5vf\">\n        <dc:Bounds x=\"922\" y=\"418\" width=\"36\" height=\"36\"/>\n        <bpmndi:BPMNLabel>\n          <dc:Bounds x=\"923\" y=\"210\" width=\"90\" height=\"12\"/>\n        </bpmndi:BPMNLabel>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNEdge id=\"SequenceFlow_088l1mq_di\" bpmnElement=\"SequenceFlow_088l1mq\">\n        <di:waypoint x=\"712\" y=\"188\"/>\n        <di:waypoint x=\"755\" y=\"188\"/>\n        <bpmndi:BPMNLabel>\n          <dc:Bounds x=\"748.5\" y=\"167\" width=\"0\" height=\"12\"/>\n        </bpmndi:BPMNLabel>\n      </bpmndi:BPMNEdge>\n      <bpmndi:BPMNEdge id=\"SequenceFlow_0jndtap_di\" bpmnElement=\"SequenceFlow_0jndtap\">\n        <di:waypoint x=\"815\" y=\"228\"/>\n        <di:waypoint x=\"815\" y=\"273\"/>\n      </bpmndi:BPMNEdge>\n      <bpmndi:BPMNShape id=\"ScriptTask_0i3knvl_di\" bpmnElement=\"Task_1d5e61v\">\n        <dc:Bounds x=\"755\" y=\"273\" width=\"120\" height=\"80\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNEdge id=\"SequenceFlow_1j3u782_di\" bpmnElement=\"SequenceFlow_1j3u782\">\n        <di:waypoint x=\"815\" y=\"353\"/>\n        <di:waypoint x=\"815\" y=\"396\"/>\n      </bpmndi:BPMNEdge>\n      <bpmndi:BPMNShape id=\"UserTask_0g52l3l_di\" bpmnElement=\"Task_08me18p\">\n        <dc:Bounds x=\"755\" y=\"396\" width=\"120\" height=\"80\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNEdge id=\"SequenceFlow_008359c_di\" bpmnElement=\"SequenceFlow_008359c\">\n        <di:waypoint x=\"875\" y=\"436\"/>\n        <di:waypoint x=\"922\" y=\"436\"/>\n      </bpmndi:BPMNEdge>\n      <bpmndi:BPMNShape id=\"UserTask_10v0853_di\" bpmnElement=\"Task_04u9ote\">\n        <dc:Bounds x=\"755\" y=\"148\" width=\"120\" height=\"80\"/>\n      </bpmndi:BPMNShape>\n    </bpmndi:BPMNPlane>\n  </bpmndi:BPMNDiagram>\n</bpmn2:definitions>"
}