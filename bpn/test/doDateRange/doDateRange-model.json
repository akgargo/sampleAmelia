{
  "id": "7f436ccd-3987-43e1-b6ae-e2b57d8ffc06",
  "name": "doDateRange",
  "type": "DETERMINISTIC",
  "description": "",
  "parentPathId": "a4efbbbf-c6e9-4e3e-97d8-3715dceb7b01",
  "revisionId": "e5a22cde-ffae-4b48-a3e1-dc4b188f7e65",
  "revisionXml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?><bpmn2:definitions xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:bpmn2=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:dc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:di=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:prop=\"http://www.ipsoft.com/schema/bpmn/prop\" id=\"sample-diagram\" targetNamespace=\"http://bpmn.io/schema/bpmn\" xsi:schemaLocation=\"http://www.omg.org/spec/BPMN/20100524/MODEL BPMN20.xsd\">\n  <bpmn2:process id=\"Process_1\" name=\"doDateRange\" isExecutable=\"false\">\n    <bpmn2:startEvent id=\"StartEvent_1\">\n      <bpmn2:outgoing>SequenceFlow_1prr5cu</bpmn2:outgoing>\n    </bpmn2:startEvent>\n    <bpmn2:sequenceFlow id=\"SequenceFlow_1prr5cu\" sourceRef=\"StartEvent_1\" targetRef=\"Task_0n8v12w\"/>\n    <bpmn2:userTask id=\"Task_0n8v12w\" name=\"say this is a test of a calendar that accepts a date range\">\n      <bpmn2:incoming>SequenceFlow_1prr5cu</bpmn2:incoming>\n      <bpmn2:incoming>SequenceFlow_0dxuqhk</bpmn2:incoming>\n      <bpmn2:outgoing>SequenceFlow_16ua7mb</bpmn2:outgoing>\n    </bpmn2:userTask>\n    <bpmn2:scriptTask id=\"Task_04cftfy\" name=\"creates calendar with blocked date range\" scriptFormat=\"groovy\">\n      <bpmn2:extensionElements>\n        <prop:property name=\"included_scripts\" value=\"\"/>\n      </bpmn2:extensionElements>\n      <bpmn2:incoming>SequenceFlow_16ua7mb</bpmn2:incoming>\n      <bpmn2:outgoing>SequenceFlow_057kwdj</bpmn2:outgoing>\n      <bpmn2:script>import groovy.json.JsonOutput\nimport java.text.SimpleDateFormat\n\ndef date = new Date()\n// current date\nsdf = new SimpleDateFormat(\"YYYY-MM-dd\")\ndef mydate = sdf.format(date)\n\n\n\ndef payload = [\n\taction: 'addChatInputIntegrationMessage',\n    payload: [\n        componentType: 'MessageIntegration',\n        subComponentType: 'DatePicker',\n\t\tformMessageType: 'datePicker',\n\t\tdata: [\n        datePickerType: 'dateRange',\n        dateFormat: 'DD-MM-YYYY',\n\t\tdateRangeStart: mydate,\n\t\tdateRangeEnd: '2019-12-28'\n\t\t]\n\t]\n]\n \ndef jsonString = JsonOutput.toJson(payload)\nprintln JsonOutput.prettyPrint(jsonString)\nexecution.setVariable('jsonString',jsonString)</bpmn2:script>\n    </bpmn2:scriptTask>\n    <bpmn2:sequenceFlow id=\"SequenceFlow_057kwdj\" sourceRef=\"Task_04cftfy\" targetRef=\"Task_1t8kxmt\"/>\n    <bpmn2:userTask id=\"Task_1t8kxmt\" name=\"send the integration message jsonString\">\n      <bpmn2:incoming>SequenceFlow_057kwdj</bpmn2:incoming>\n      <bpmn2:outgoing>SequenceFlow_0haqa51</bpmn2:outgoing>\n    </bpmn2:userTask>\n    <bpmn2:userTask id=\"Task_0uvkf30\" name=\"ask &quot;When would you like to apply time off?&quot;\">\n      <bpmn2:incoming>SequenceFlow_0haqa51</bpmn2:incoming>\n      <bpmn2:outgoing>SequenceFlow_1jb7cue</bpmn2:outgoing>\n    </bpmn2:userTask>\n    <bpmn2:sequenceFlow id=\"SequenceFlow_0haqa51\" sourceRef=\"Task_1t8kxmt\" targetRef=\"Task_0uvkf30\"/>\n    <bpmn2:sequenceFlow id=\"SequenceFlow_1jb7cue\" sourceRef=\"Task_0uvkf30\" targetRef=\"Task_1ae18lc\"/>\n    <bpmn2:scriptTask id=\"Task_0c7kq5j\" name=\"creates chat notes\" scriptFormat=\"groovy\">\n      <bpmn2:extensionElements>\n        <prop:property name=\"included_scripts\" value=\"\"/>\n      </bpmn2:extensionElements>\n      <bpmn2:incoming>SequenceFlow_0fp2cdt</bpmn2:incoming>\n      <bpmn2:outgoing>SequenceFlow_044yo6z</bpmn2:outgoing>\n      <bpmn2:script>import groovy.json.JsonOutput\n \ndef lblDateRange = execution.getVariable('dateRange')\ndef lblNoOfDays = execution.getVariable('noOfDays')\ndef lblUserName = execution.userDisplayName();\n\ndef payload = [\n    action       : 'addChatNotesIntegration',\n    componentType: 'ChatNote',\n    payload      : [\n        [\n        component    : 'ChatNote',\n        header       : 'Welcome to Amelia',\n        title        : 'Leave Application Info',\n        subcomponents: [\n            [\n            subcomponent: 'Markup',\n            markupType  : 'Text',\n            label       : 'Name:',\n            value       : lblUserName \n            ],\n            [\n            subcomponent: 'Markup',\n            markupType  : 'Text',\n            label       : 'Leave Range',\n            value       : lblDateRange \n            ],\n            [\n            subcomponent: 'Markup',\n            markupType  : 'Text',\n            label       : 'No of day(s)',\n            value       : lblNoOfDays \n            ],\n        ]\n \n        ]\n    ]\n]\n \ndef jsonString = JsonOutput.toJson(payload)\n\nexecution.setVariable('jsonString',jsonString)</bpmn2:script>\n    </bpmn2:scriptTask>\n    <bpmn2:sequenceFlow id=\"SequenceFlow_044yo6z\" sourceRef=\"Task_0c7kq5j\" targetRef=\"Task_0rfx1xo\"/>\n    <bpmn2:userTask id=\"Task_0rfx1xo\" name=\"send the integration message jsonString\">\n      <bpmn2:incoming>SequenceFlow_044yo6z</bpmn2:incoming>\n      <bpmn2:outgoing>SequenceFlow_1005vr9</bpmn2:outgoing>\n    </bpmn2:userTask>\n    <bpmn2:sequenceFlow id=\"SequenceFlow_16ua7mb\" sourceRef=\"Task_0n8v12w\" targetRef=\"Task_04cftfy\"/>\n    <bpmn2:scriptTask id=\"Task_1ae18lc\" name=\"calculate no of days\" scriptFormat=\"groovy\">\n      <bpmn2:extensionElements>\n        <prop:property name=\"included_scripts\" value=\"\"/>\n      </bpmn2:extensionElements>\n      <bpmn2:incoming>SequenceFlow_1jb7cue</bpmn2:incoming>\n      <bpmn2:outgoing>SequenceFlow_0fp2cdt</bpmn2:outgoing>\n      <bpmn2:script>import groovy.json.JsonOutput\n \ndef dateRange = execution.getVariable('response')\n\ndef pattern = \"dd-MM-yyyy\"\ndef inNoOfDays = 0\ndef fromDate\ndef toDate \n\n\nif (dateRange.tokenize()[0] != null &amp;&amp; \ndateRange.tokenize()[2] != null){\n fromDate = Date.parse(pattern, dateRange.tokenize()[0])\n toDate = Date.parse(pattern, dateRange.tokenize()[2])\n \n    fromDate.upto(toDate) { \n    if (!(it[Calendar.DAY_OF_WEEK] in [1,7] )) {\n        inNoOfDays++\n        }\n    }\n    \n} else {\n    inNoOfDays = \"0\"\n    fromDate = Date.parse(pattern, dateRange.tokenize()[0])\n    if (!(fromDate[Calendar.DAY_OF_WEEK] in [1,7] )) {\n      inNoOfDays = \"1\"\n    }\n} \n\nexecution.setVariable('noOfDays',inNoOfDays)\nexecution.setVariable('dateRange',dateRange)</bpmn2:script>\n    </bpmn2:scriptTask>\n    <bpmn2:sequenceFlow id=\"SequenceFlow_0fp2cdt\" sourceRef=\"Task_1ae18lc\" targetRef=\"Task_0c7kq5j\"/>\n    <bpmn2:sequenceFlow id=\"SequenceFlow_1005vr9\" sourceRef=\"Task_0rfx1xo\" targetRef=\"Task_09jjqsu\"/>\n    <bpmn2:scriptTask id=\"Task_09jjqsu\" name=\"Yes No Proceed\" scriptFormat=\"groovy\">\n      <bpmn2:extensionElements>\n        <prop:property name=\"included_scripts\" value=\"\"/>\n      </bpmn2:extensionElements>\n      <bpmn2:incoming>SequenceFlow_1005vr9</bpmn2:incoming>\n      <bpmn2:outgoing>SequenceFlow_0zh2k22</bpmn2:outgoing>\n      <bpmn2:script>def yesNoButton = formInputDataBuilder.create()\n          .name(\"flavorSelection\")\n          .nameForDisplay(\"Proceed Form\")\n          .formType(\"sampleForm\")\n          .staticSelectionUtterance(\"\")\n          .allowedUserInputs(\"form_only\")\n          .addField()\n              .name(\"flavorSelectionField\")\n              .fieldType(\"singleSelection\")\n              .postfixedSelectionUtterance(\"\", \"\")\n              .addOption()\n                  .name(\"Yes\")\n                  .value(\"yes\")\n                  .backToField()\n              .addOption()\n                  .name(\"No\")\n                  .value(\"no\")\n                  .backToField()\n              .backToForm()\n          .build();\n\nexecution.setVariable(\"dateConfirmYesNoButton\", yesNoButton.toString())</bpmn2:script>\n    </bpmn2:scriptTask>\n    <bpmn2:sequenceFlow id=\"SequenceFlow_0zh2k22\" sourceRef=\"Task_09jjqsu\" targetRef=\"Task_1t0jqcm\"/>\n    <bpmn2:userTask id=\"Task_1t0jqcm\" name=\"ask &quot;Confirm your selection ?&quot;\">\n      <bpmn2:extensionElements>\n        <prop:property name=\"form_input_data_variable\" value=\"dateConfirmYesNoButton\"/>\n      </bpmn2:extensionElements>\n      <bpmn2:incoming>SequenceFlow_0zh2k22</bpmn2:incoming>\n      <bpmn2:outgoing>SequenceFlow_0qggk5f</bpmn2:outgoing>\n      <bpmn2:outgoing>SequenceFlow_0dxuqhk</bpmn2:outgoing>\n    </bpmn2:userTask>\n    <bpmn2:sequenceFlow id=\"SequenceFlow_0qggk5f\" name=\"yes\" sourceRef=\"Task_1t0jqcm\" targetRef=\"Task_05qvsc4\">\n      <bpmn2:extensionElements>\n        <prop:property name=\"expression\" value=\"response:yes()\"/>\n      </bpmn2:extensionElements>\n    </bpmn2:sequenceFlow>\n    <bpmn2:userTask id=\"Task_05qvsc4\" name=\"say Bye\">\n      <bpmn2:incoming>SequenceFlow_0qggk5f</bpmn2:incoming>\n      <bpmn2:outgoing>SequenceFlow_01vb3uv</bpmn2:outgoing>\n    </bpmn2:userTask>\n    <bpmn2:sequenceFlow id=\"SequenceFlow_0dxuqhk\" name=\"No\" sourceRef=\"Task_1t0jqcm\" targetRef=\"Task_0n8v12w\">\n      <bpmn2:extensionElements>\n        <prop:property name=\"expression\" value=\"response:no()\"/>\n      </bpmn2:extensionElements>\n    </bpmn2:sequenceFlow>\n    <bpmn2:endEvent id=\"EndEvent_0acgm0l\">\n      <bpmn2:incoming>SequenceFlow_01vb3uv</bpmn2:incoming>\n    </bpmn2:endEvent>\n    <bpmn2:sequenceFlow id=\"SequenceFlow_01vb3uv\" sourceRef=\"Task_05qvsc4\" targetRef=\"EndEvent_0acgm0l\"/>\n  </bpmn2:process>\n  <bpmndi:BPMNDiagram id=\"BPMNDiagram_1\">\n    <bpmndi:BPMNPlane id=\"BPMNPlane_1\" bpmnElement=\"Process_1\">\n      <bpmndi:BPMNShape id=\"_BPMNShape_StartEvent_2\" bpmnElement=\"StartEvent_1\">\n        <dc:Bounds x=\"324\" y=\"416\" width=\"36\" height=\"36\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNEdge id=\"SequenceFlow_1prr5cu_di\" bpmnElement=\"SequenceFlow_1prr5cu\">\n        <di:waypoint x=\"360\" y=\"434\"/>\n        <di:waypoint x=\"413\" y=\"434\"/>\n        <bpmndi:BPMNLabel>\n          <dc:Bounds x=\"238.5\" y=\"167\" width=\"0\" height=\"12\"/>\n        </bpmndi:BPMNLabel>\n      </bpmndi:BPMNEdge>\n      <bpmndi:BPMNShape id=\"UserTask_1ipvy6u_di\" bpmnElement=\"Task_0n8v12w\">\n        <dc:Bounds x=\"413\" y=\"394\" width=\"100\" height=\"80\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNShape id=\"ScriptTask_1c4xwih_di\" bpmnElement=\"Task_04cftfy\">\n        <dc:Bounds x=\"418\" y=\"148\" width=\"120\" height=\"80\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNEdge id=\"SequenceFlow_057kwdj_di\" bpmnElement=\"SequenceFlow_057kwdj\">\n        <di:waypoint x=\"538\" y=\"188\"/>\n        <di:waypoint x=\"584\" y=\"188\"/>\n        <bpmndi:BPMNLabel>\n          <dc:Bounds x=\"546.5\" y=\"167\" width=\"90\" height=\"12\"/>\n        </bpmndi:BPMNLabel>\n      </bpmndi:BPMNEdge>\n      <bpmndi:BPMNShape id=\"UserTask_1hvkbh2_di\" bpmnElement=\"Task_1t8kxmt\">\n        <dc:Bounds x=\"584\" y=\"148\" width=\"120\" height=\"80\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNShape id=\"UserTask_11r1680_di\" bpmnElement=\"Task_0uvkf30\">\n        <dc:Bounds x=\"741\" y=\"148\" width=\"120\" height=\"80\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNEdge id=\"SequenceFlow_0haqa51_di\" bpmnElement=\"SequenceFlow_0haqa51\">\n        <di:waypoint x=\"704\" y=\"188\"/>\n        <di:waypoint x=\"741\" y=\"188\"/>\n        <bpmndi:BPMNLabel>\n          <dc:Bounds x=\"762.5\" y=\"167\" width=\"0\" height=\"12\"/>\n        </bpmndi:BPMNLabel>\n      </bpmndi:BPMNEdge>\n      <bpmndi:BPMNEdge id=\"SequenceFlow_1jb7cue_di\" bpmnElement=\"SequenceFlow_1jb7cue\">\n        <di:waypoint x=\"861\" y=\"188\"/>\n        <di:waypoint x=\"893\" y=\"188\"/>\n        <bpmndi:BPMNLabel>\n          <dc:Bounds x=\"957.5\" y=\"167\" width=\"0\" height=\"12\"/>\n        </bpmndi:BPMNLabel>\n      </bpmndi:BPMNEdge>\n      <bpmndi:BPMNShape id=\"ScriptTask_12798o8_di\" bpmnElement=\"Task_0c7kq5j\">\n        <dc:Bounds x=\"1064\" y=\"148\" width=\"120\" height=\"80\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNEdge id=\"SequenceFlow_044yo6z_di\" bpmnElement=\"SequenceFlow_044yo6z\">\n        <di:waypoint x=\"1124\" y=\"228\"/>\n        <di:waypoint x=\"1124\" y=\"265\"/>\n      </bpmndi:BPMNEdge>\n      <bpmndi:BPMNShape id=\"UserTask_15lcrgc_di\" bpmnElement=\"Task_0rfx1xo\">\n        <dc:Bounds x=\"1064\" y=\"265\" width=\"120\" height=\"80\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNEdge id=\"SequenceFlow_16ua7mb_di\" bpmnElement=\"SequenceFlow_16ua7mb\">\n        <di:waypoint x=\"463\" y=\"394\"/>\n        <di:waypoint x=\"463\" y=\"228\"/>\n      </bpmndi:BPMNEdge>\n      <bpmndi:BPMNShape id=\"ScriptTask_1o2s0tx_di\" bpmnElement=\"Task_1ae18lc\">\n        <dc:Bounds x=\"893\" y=\"148\" width=\"120\" height=\"80\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNEdge id=\"SequenceFlow_0fp2cdt_di\" bpmnElement=\"SequenceFlow_0fp2cdt\">\n        <di:waypoint x=\"1013\" y=\"188\"/>\n        <di:waypoint x=\"1064\" y=\"188\"/>\n      </bpmndi:BPMNEdge>\n      <bpmndi:BPMNEdge id=\"SequenceFlow_1005vr9_di\" bpmnElement=\"SequenceFlow_1005vr9\">\n        <di:waypoint x=\"1184\" y=\"305\"/>\n        <di:waypoint x=\"1227\" y=\"305\"/>\n      </bpmndi:BPMNEdge>\n      <bpmndi:BPMNShape id=\"ScriptTask_0nfqwy0_di\" bpmnElement=\"Task_09jjqsu\">\n        <dc:Bounds x=\"1227\" y=\"265\" width=\"120\" height=\"80\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNEdge id=\"SequenceFlow_0zh2k22_di\" bpmnElement=\"SequenceFlow_0zh2k22\">\n        <di:waypoint x=\"1287\" y=\"345\"/>\n        <di:waypoint x=\"1287\" y=\"394\"/>\n      </bpmndi:BPMNEdge>\n      <bpmndi:BPMNShape id=\"UserTask_1lckdzd_di\" bpmnElement=\"Task_1t0jqcm\">\n        <dc:Bounds x=\"1227\" y=\"394\" width=\"120\" height=\"80\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNEdge id=\"SequenceFlow_0qggk5f_di\" bpmnElement=\"SequenceFlow_0qggk5f\">\n        <di:waypoint x=\"1347\" y=\"434\"/>\n        <di:waypoint x=\"1392\" y=\"434\"/>\n        <bpmndi:BPMNLabel>\n          <dc:Bounds x=\"1364\" y=\"416\" width=\"17\" height=\"14\"/>\n        </bpmndi:BPMNLabel>\n      </bpmndi:BPMNEdge>\n      <bpmndi:BPMNShape id=\"UserTask_0qxrqng_di\" bpmnElement=\"Task_05qvsc4\">\n        <dc:Bounds x=\"1392\" y=\"394\" width=\"120\" height=\"80\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNEdge id=\"SequenceFlow_0dxuqhk_di\" bpmnElement=\"SequenceFlow_0dxuqhk\">\n        <di:waypoint x=\"1227\" y=\"434\"/>\n        <di:waypoint x=\"513\" y=\"434\"/>\n        <bpmndi:BPMNLabel>\n          <dc:Bounds x=\"863\" y=\"416\" width=\"15\" height=\"14\"/>\n        </bpmndi:BPMNLabel>\n      </bpmndi:BPMNEdge>\n      <bpmndi:BPMNShape id=\"EndEvent_0acgm0l_di\" bpmnElement=\"EndEvent_0acgm0l\">\n        <dc:Bounds x=\"1548\" y=\"416\" width=\"36\" height=\"36\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNEdge id=\"SequenceFlow_01vb3uv_di\" bpmnElement=\"SequenceFlow_01vb3uv\">\n        <di:waypoint x=\"1512\" y=\"434\"/>\n        <di:waypoint x=\"1548\" y=\"434\"/>\n      </bpmndi:BPMNEdge>\n    </bpmndi:BPMNPlane>\n  </bpmndi:BPMNDiagram>\n</bpmn2:definitions>",
  "domainId": "65e03585-771b-4db9-8a7d-8f81b866c237",
  "status": "DEPLOYED"
}